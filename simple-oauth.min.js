/*! SimpleOAuth: Simply builds OAuth 1.0 headers (v0.1 built 2013-05-15)
* https://github.com/bseth99/simple-oauth
* Copyright 2013 Ben Olson; Licensed MIT */
(function(e){function r(e){var e=e||16,t="",r=0,i,s=n.length;for(;r<e;r++)i=Math.floor(Math.random()*s),t+=n.substring(i,i+1);return t}function i(){var e=new Date;return""+Math.floor(e.getTime()/1e3)}function u(e,t,n,r){function i(e,t,n,r){return e<20?t&n|~t&r:e<40?t^n^r:e<60?t&n|t&r|n&r:t^n^r}function s(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function o(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function u(e,t){return e<<t|e>>>32-t}function a(e,t){e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;var n=[80],r=1732584193,a=-271733879,f=-1732584194,l=271733878,c=-1009589776;for(var h=0;h<e.length;h+=16){var p=r,d=a,v=f,m=l,g=c;for(var y=0;y<80;y++){y<16?n[y]=e[h+y]:n[y]=u(n[y-3]^n[y-8]^n[y-14]^n[y-16],1);var b=o(o(u(r,5),i(y,a,f,l)),o(o(c,n[y]),s(y)));c=l,l=f,f=u(a,30),a=r,r=b}r=o(r,p),a=o(a,d),f=o(f,v),l=o(l,m),c=o(c,g)}return[r,a,f,l,c]}function f(e){var t=[],n=(1<<r)-1;for(var i=0;i<e.length*r;i+=r)t[i>>5]|=(e.charCodeAt(i/8)&n)<<32-r-i%32;return t}function l(e,t){var n=f(e);n.length>16&&(n=a(n,e.length*r));var i=[16],s=[16];for(var o=0;o<16;o++)i[o]=n[o]^909522486,s[o]=n[o]^1549556828;var u=a(i.concat(f(t)),512+t.length*r);return a(s.concat(u),672)}function c(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="";for(var i=0;i<e.length*4;i+=3){var s=(e[i>>2]>>8*(3-i%4)&255)<<16|(e[i+1>>2]>>8*(3-(i+1)%4)&255)<<8|e[i+2>>2]>>8*(3-(i+2)%4)&255;for(var o=0;o<4;o++)i*8+o*6>e.length*32?r+=n:r+=t.charAt(s>>6*(3-o)&63)}return r}function h(e,t){return c(l(e,t))}return n||(n="="),r||(r=8),h(e,t)}var t=["callback","consumer_key","nonce","signature_method","timestamp","token","verifier","version"],n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";SimpleOAuth={};var s=function(e,t,n,r){var r=r||{};this.method=e.toUpperCase(),this.uri=URI.parseUri(t),this.uri.fragment="",this.uri.normalize(),this.params=n,this.options=_.extend(s.default_options(),r)};s.default_options=function(){return{nonce:r(),signature_method:"HMAC-SHA1",timestamp:i(),version:"1.0"}},s.escape=function(e){return encodeURIComponent(e).replace(/\!/g,"%21").replace(/\*/g,"%2A").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")},s.unescape=function(e){return decodeURIComponent(e)},_.extend(s.prototype,{url:function(){var e=_.clone(this.uri);return e.query=null,e.build()},build:function(e){var e=e||"header",t;return e=="header"?t="OAuth "+this.normalized_header_attributes(", "):e=="query"&&(t=this.normalized_query_attributes("&")),t},signed_attributes:function(){var e=_.clone(this.attributes());return e.oauth_signature=this.signature(),e},normalized_header_attributes:function(){return _.map(_.sortBy(_.pairs(this.signed_attributes()),function(e){return e[0]}),function(e){return e[0]+'="'+s.escape(e[1])+'"'}).join(", ")},normalized_query_attributes:function(){return _.map(_.sortBy(_.pairs(this.signed_attributes()),function(e){return e[0]}),function(e){return e[0]+"="+s.escape(e[1])}).join("&")},attributes:function(){var e={},n=this.options;return _.each(t,function(t){n[t]&&(e["oauth_"+t]=n[t])}),e},signature:function(){return this.hmac_sha1_signature()},hmac_sha1_signature:function(){return u(this.secret(),this.signature_base())},secret:function(){var e=_.pick(this.options,"consumer_secret","token_secret");return e.consumer_secret=e.consumer_secret||"",e.token_secret=e.token_secret||"",_.map(e,function(e){return s.escape(e)}).join("&")},signature_base:function(){return _.map([this.method,this.url(),this.normalized_params()],function(e){return s.escape(e)}).join("&")},normalized_params:function(){return _.map(_.map(this.signature_params(),function(e){return _.map(e,function(e){return s.escape(e)})}).sort(),function(e){return e.join("=")}).join("&")},signature_params:function(){return _.pairs(this.attributes()).concat(_.pairs(this.params),this.url_params())},url_params:function(){var e=[];return _.each(URI.parseQuery(this.uri.query||""),function(t,n){e.push(_(_.flatten([t]).sort()).chain().map(function(e){return[n,e]}).value())}),_.flatten(e,!0)}}),SimpleOAuth.Header=s;var o=function(e){_.extend(this,e),this.default_port="";switch(this.scheme){case"http":this.default_port="80";break;case"https":this.default_port="443"}};_.extend(o.prototype,{normalize:function(){this.path&&this.path==""&&(this.path="/"),this.scheme&&this.scheme!=this.scheme.toLowerCase()&&(this.scheme=this.scheme.toLowerCase()),this.host&&this.host!=this.host.toLowerCase()&&(this.host=this.host.toLowerCase())},build:function(){var e="";return this.scheme&&(e+=this.scheme,e+=":"),this.opaque?e+=this.opaque:(this.host&&(e+="//"),this.userinfo&&(e+=this.userinfo,e+="@"),this.host&&(e+=this.host),this.port&&this.port!=this.default_port&&(e+=":",e+=this.port),e+=this.path,this.query&&(e+="?",e+=this.query)),this.fragment&&(e+="#",e+=this.fragment),e}}),URI={parseQuery:function(e){var t=(e||"").split("&"),n={},r;for(r=t.shift();r;r=t.shift()){var i=r.split("="),s="";i[1]&&(s=decodeURIComponent(i[1])),n[i[0]]?n[i[0]]instanceof Array?_.isArray(n[i[0]])?n[i[0]].push(s):n[i[0]]=[n[i[0]],s]:n[i[0]]=Array(n[i[0]],s):n[i[0]]=s}return n},queryString:function(e){return _.map(e,function(e,t){return t+"="+encodeURIComponent(e)}).join("&")},parseUri:function(e){var t=URI.options,n=t.parser[t.strictMode?"strict":"loose"].exec(e),r={},i=14;while(i--)r[t.key[i]]=n[i]||"";return r[t.q.name]={},r[t.key[12]].replace(t.q.parser,function(e,n,i){n&&(r[t.q.name][n]=i)}),new o(r)},options:{strictMode:!0,key:["source","scheme","authority","userinfo","user","password","host","port","relative","path","directory","file","query","fragment"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}}}})();